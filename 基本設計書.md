# NextExplorer - デスクトップフォルダ管理アプリ
## 基本設計書

### 1. 概要
**プロジェクト名**: NextExplorer  
**目的**: Windowsデスクトップで開かれているフォルダパスを記憶し、名前付きで管理して一括で再オープンできるアプリケーション

### 2. 機能要件

#### 2.1 主要機能
- **フォルダ状態取得機能**: 現在開かれているエクスプローラーウィンドウのパス一覧を取得
- **セッション保存機能**: 取得したフォルダパス群を名前付きで保存
- **セッション管理機能**: 保存されたセッションの一覧表示、編集、削除
- **一括復元機能**: 選択したセッションの全フォルダを一括でオープン
- **自動保存機能**: アプリ終了時の自動セッション保存（オプション）

#### 2.2 補助機能
- **フォルダ存在チェック**: 復元時に存在しないフォルダの警告表示
- **重複除去**: 同じパスの重複を自動除去
- **履歴管理**: 最近使用したセッションの履歴表示
- **設定管理**: アプリケーション設定の保存・読込

### 3. 非機能要件

#### 3.1 パフォーマンス
- フォルダ状態取得: 1秒以内
- セッション復元: 5秒以内（10フォルダの場合）
- UI応答性: 200ms以内

#### 3.2 可用性
- Windows 10/11対応
- .NET Framework 4.8以上または.NET 6.0以上
- 最小システム要件: メモリ100MB以下、ディスク容量50MB以下

#### 3.3 保守性
- モジュラー設計による機能分離
- 設定ファイルによるカスタマイズ対応
- ログ出力機能

### 4. システム構成

#### 4.1 開発技術
- **言語**: C#
- **フレームワーク**: WPF (.NET 6.0)
- **データ保存**: JSON形式
- **Windows API**: Shell32, User32

#### 4.2 アーキテクチャ
```
┌─────────────────┐
│   Presentation  │  ← WPF UI Layer
│     Layer       │
├─────────────────┤
│   Business      │  ← ビジネスロジック
│     Layer       │
├─────────────────┤
│   Data Access   │  ← データ永続化
│     Layer       │
├─────────────────┤
│   Windows API   │  ← システム連携
│     Layer       │
└─────────────────┘
```

### 5. 外部インターフェース

#### 5.1 Windows Shell API
- `SHGetFolderLocation()`: フォルダパス取得
- `EnumWindows()`: ウィンドウ一覧取得
- `GetWindowText()`: ウィンドウタイトル取得

#### 5.2 ファイルシステム
- セッションデータ: `%APPDATA%\NextExplorer\sessions.json`
- 設定ファイル: `%APPDATA%\NextExplorer\config.json`
- ログファイル: `%APPDATA%\NextExplorer\logs\`

### 6. セキュリティ要件
- ユーザーデータの暗号化（設定で有効/無効選択可）
- 不正パスアクセスの防止
- アプリケーション署名による信頼性確保

### 7. 制約事項
- Windows OSでのみ動作
- エクスプローラーウィンドウのみ対象（他のファイルマネージャー非対応）
- ネットワークドライブの一部制限あり

### 8. 今後の拡張予定
- 複数ディスプレイ対応
- フォルダ階層表示機能
- セッションのエクスポート/インポート機能
- ホットキー対応